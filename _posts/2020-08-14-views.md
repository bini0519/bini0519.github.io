---
title: views.py
tags: Django Python views.py
---

**views.py íŒŒì¼ì˜ ì½”ë“œ êµ¬ì„± ì•Œì•„ë³´ê¸°**
ì£¼ì˜ : ì½”ë“œ í˜•ì‹ë§Œ ë³´ê¸°
> views.pyì—ì„œ í•¨ìˆ˜ ì •ì˜ë¿ë§Œ ì•„ë‹ˆë¼ classì„ ì–¸ë„ ê°€ëŠ¥í•˜ë‹¤.

```python
#ë‚´ì¥ í•¨ìˆ˜
from django.shortcuts import render,redirect,get_object_or_404
from django.http import Http404
from django.core.exceptions import PermissionDenied
from django.contrib.auth.decorators import login_required

#ë‚´ê°€ ë§Œë“  í¼/ëª¨ë¸
from .forms import JssForm, CommentForm
from .models import Jasoseol
```

Jasoseal class ë§Œë“¤ê¸°
---
```python
class Jasoseol(models.Model):
    #ì œëª© ê¸€ì ì œí•œ
    title = models.CharField(max_length=50)
    #ë‚´ìš©
    content = models.TextField()
    #ë‚ ì§œì™€ ì‹œê°„ì€ ìë™ìƒì„±
    updated_at = models.DateTimeField(auto_now=True)

    #ì‘ì„±ìê°€ ì§€ì›Œì§ˆ ë•Œ ì—°ê²°ëœ ìì†Œì„¤ë„ ì§€ì›Œì§„ë‹¤.
    #ë‹¤ì‹œ ë§í•´, user ëª¨ë¸ì„ ì‚­ì œí•˜ë©´ Jasosealëª¨ë¸ë„ ì‚¬ë¼ì§„ë‹¤.
    author = models.ForeignKey(User, on_delete=models.CASCADE)
```

index í•¨ìˆ˜ ì •ì˜í•˜ê¸°
---
```python
def index(request):
    all_jss = Jasoseol.objects.all()
    return render(request, "index.html", {'all_jss':all_jss})
```
**objectsë¥¼ ê°€ì ¸ì˜¤ëŠ” ì—¬ëŸ¬ ë°©ë²•ë“¤**
>ëª¨ë¸.objects.all() : í•´ë‹¹ëª¨ë¸ë¡œ ë§Œë“  ëª¨ë“  ê°ì²´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.  
>ëª¨ë¸.objects.get(pkë“±): í•´ë‹¹ëª¨ë¸ì˜ í•˜ë‚˜ì˜ ê°’(pkê°’)ì— í•´ë‹¹ë˜ëŠ” ê°ì²´ë§Œ ê°€ì ¸ì˜¨ë‹¤.  
>ëª¨ë¸.objects.filter(ì¡°ê±´):í•´ë‹¹ì¡°ê±´ì— ë§ëŠ” ëª¨ë“  ê°ì²´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.  
>ğŸ’» ê²€ìƒ‰ê¸°ëŠ¥ì— ë§ì´ ì“´ë‹¤.

create í•¨ìˆ˜ ë§Œë“¤ê¸°
---

```python
@login_required(login_url='/login/')
def create(request):
    if not request.user.is_authenticated:
        return redirect('login')

    if request.method == "POST":
        filled_form = JssForm(request.POST)

        #ìš°ë¦¬ê°€ ì§€ì •í•œ formí˜•ì‹ì„ ë”°ë¥¸ë‹¤ë©´
        if filled_form.is_valid():
            temp_form = filled_form.save(commit=False)
            temp_form.author = request.user
            temp_form.save()
            return redirect('index')
    jss_form = JssForm()
    return render(request, "create.html", {'jss_form':jss_form})
```
@login_required(login_url='/login/')  
ë˜ëŠ”  
if not user.is_authenticated  
-> ë¡œê·¸ì¸ì´ ë˜ì§€ ì•Šì•˜ë‹¤ë©´ ì €ê¸° urlë¡œ ì´ë™í•œë‹¤.

detail í•¨ìˆ˜ ë§Œë“¤ê¸°
---
```python
@login_required(login_url='/login/')
def detail(request, jss_id):

    my_jss = get_object_or_404(Jasoseol, pk=jss_id)
    comment_form = CommentForm()
    return render(request, 'detail.html',{'my_jss':my_jss, 'comment_form':comment_form})
```

delete í•¨ìˆ˜ ë§Œë“¤ê¸°
---
```python
def delete(request, jss_id):
    my_jss = Jasoseol.objects.get(pk=jss_id)
    if request.user == my_jss.author:
        my_jss.delete()
        return redirect('index')

    #ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¨ë‹¤
    raise PermissionDenied
```

ê²Œì‹œê¸€ ìˆ˜ì •
---
```python
def update(request, jss_id):
    my_jss = Jasoseol.objects.get(pk=jss_id)
    jss_form = JssForm(instance=my_jss)
    if request.method == "POST":
        updated_form = JssForm(request.POST, instance=my_jss)
        if updated_form.is_valid():
            updated_form.save()
            return redirect('index')
    return render(request, 'create.html', {'jss_form':jss_form})
```

ëŒ“ê¸€ ì¶”ê°€/ì‚­ì œ ê¸°ëŠ¥ ë§Œë“¤ê¸°
---
```python
def create_comment(request, jss_id):
    #ëª¨ë¸í¼ ëŒ€ì…
    comment_form = CommentForm(request.POST)
    if comment_form.is_valid():
        temp_form = comment_form.save(commit=False)
        # ê°ì²´ê°€ ë§Œë“¤ì–´ì§€ê¸° ì „ì— ì ê¹ ì§€ì—°ì‹œí‚¨ë‹¤.
        # í•´ë‹¹ ëª¨ë¸í¼ê³¼ ì—°ê²°ë˜ì—ˆë˜ ëª¨ë¸ì´ ëŒ€ì…ëœë‹¤.
        temp_form.author = request.user
        temp_form.jasoseal = Jasoseol.objects.get(pk=jss_id)
        temp_form.save()
        return redirect('detail', jss_id)

def delete_comment(request, jss_id, comment_id):
    my_comment = Comment.objects.get(pk=comment_id)
    if request.user == my_comment.author:
        my_comment.delete()
        return redirect('detail', jss_id)
    else:
        raise PermissionDenied
```


